# Generic
TypeScriptì—ì„œ **Generics(ì œë„¤ë¦­)**ì€ ìœ ì—°ì„±ê³¼ íƒ€ì… ì •ë³´ë¥¼ ë™ì‹œì— ì–»ì„ ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤. JavaScriptì˜ ë™ì  íŠ¹ì„±ì„ ì •ì  íƒ€ì… ì‹œìŠ¤í…œì— ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ë‚´ëŠ” ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.

- í•µì‹¬ ê°œë… ìš”ì•½
  - ì¼ë°˜ í•¨ìˆ˜ëŠ” íƒ€ì…ì„ ê³ ì •ì‹œì¼œì•¼ í•˜ë¯€ë¡œ, ìœ ì—°ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
  ì œë„¤ë¦­ í•¨ìˆ˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ ì‹œì ì— ì‹¤ì œ íƒ€ì…ìœ¼ë¡œ ëŒ€ì²´ë˜ë¯€ë¡œ ìœ ì—°ì„±ê³¼ íƒ€ì… ì•ˆì „ì„±ì„ ëª¨ë‘ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  -ì œë„¤ë¦­ì€ íŠ¹íˆ ì…ë ¥ ê°’ë“¤ ê°„ì˜ ê´€ê³„ë‚˜ ì…ë ¥ê³¼ ë°˜í™˜ê°’ ê°„ì˜ ê´€ê³„ë¥¼ ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆì–´ ë³µì¡í•œ êµ¬ì¡°ì˜ íƒ€ì… í‘œí˜„ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

## 4.1 í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ì¼ë°˜í™”í•˜ê¸°
âœ… ë¬¸ì œ
ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ íƒ€ì…ì„ ë‹¤ë£¨ëŠ” í•¨ìˆ˜ê°€ ìˆìŒ.

âœ… í•´ê²°
í•¨ìˆ˜ì— ì œë„¤ë¦­ íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë™ì‘ì„ ì¼ë°˜í™”í•¨.


```typescript
type Languages = { de: URL; en: URL; fr: URL };
type AllowedElements = { video: HTMLVideoElement; audio: HTMLAudioElement };

function isLanguageAvailable(collection: Languages, lang: string): lang is keyof Languages {
  return lang in collection;
}

function isElementAllowed(collection: AllowedElements, elem: string): elem is keyof AllowedElements {
  return elem in collection;
}

```
- ë‘ í•¨ìˆ˜ëŠ” ì…ë ¥ ê°ì²´ì™€ í‚¤ë¥¼ ë°›ì•„ in ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì ì—ì„œ êµ¬ì¡°ê°€ ê°™ì§€ë§Œ,
  ê°ê¸° ë‹¤ë¥¸ íƒ€ì… ë•Œë¬¸ì— ì¤‘ë³µëœ êµ¬í˜„ì´ ë°œìƒí•¨.

```typescript
function isAvailable<Obj>(
  obj: Obj,
  key: string | number | symbol
): key is keyof Obj {
  return key in obj;
}
```
- ì´ì œ ì–´ë–¤ ê°ì²´ íƒ€ì…ì´ë“  isAvailableì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.

```typescript
type Languages = { en: URL; fr: URL; };
type AllowedElements = { video: HTMLVideoElement; };

isAvailable(languages, "en");       // íƒ€ì… ì•ˆì „
isAvailable(allowedElements, "video"); // íƒ€ì… ì•ˆì „

```
### 4.2 ê´€ë ¨ëœ í•¨ìˆ˜ ì¸ìˆ˜ ë§Œë“¤ê¸°
âœ… ë¬¸ì œ
ë‘ ë²ˆì§¸ ì¸ìëŠ” ì²« ë²ˆì§¸ ì¸ìì˜ íƒ€ì…ì— ë”°ë¼ ë‹¬ë¼ì ¸ì•¼ í•¨.

âœ… í•´ê²°
ì œë„¤ë¦­ íƒ€ì… ê°„ì˜ ê´€ê³„ë¥¼ ëª…ì‹œí•˜ì—¬ íƒ€ì… ì•ˆì „ì„ í™•ë³´.
ğŸ“Œ ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤: ë‹¤êµ­ì–´ ìë§‰ ë°ì´í„°
```typescript
type Languages = {
  de: URL;
  en: URL;
  pt: URL;
  es: URL;
  fr: URL;
  ja: URL;
};

const languages: Languages = { /* ìƒëµ */ };
```
ìš°ë¦¬ëŠ” íŠ¹ì • ì–¸ì–´ ìë§‰ì„ ë¡œë“œí•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ:

```typescript
type Languages = {
  de: URL;
  fr: URL;
  ja: URL;
};

function fetchFile(urls: Languages, key: string) {
  return fetch(urls[key]); // âŒ keyê°€ stringì´ë©´ ì–´ë–¤ ë¬¸ìì—´ë„ ë“¤ì–´ì˜¬ ìˆ˜ ìˆìŒ â†’ "it"ë„ í†µê³¼ë¨
}

const languages: Languages = {
  de: new URL("https://example.com/de.json"),
  fr: new URL("https://example.com/fr.json"),
  ja: new URL("https://example.com/ja.json"),
};

fetchFile(languages, "de"); // OK
fetchFile(languages, "it"); // â—ï¸ë¬¸ì œ: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤ì§€ë§Œ í†µê³¼ë¨
```
- ë¬¸ì œì 
  - keyê°€ ë‹¨ìˆœíˆ string íƒ€ì…ì´ë¼ë©´ "it" ê°™ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤ë„ í—ˆìš©ë¨ â†’
  ì´ê±´ íƒ€ì… ì•ˆì „ì„±ì„ ìœ„í˜‘í•¨.
  
âœ… í•´ê²° ë°©ë²•: ì œë„¤ë¦­ íƒ€ì…ê³¼ ì œì•½ ì¡°ê±´ ì‚¬ìš©í•˜ê¸°
```typescript
type URLList = { [key: string]: URL }; // ì¼ë°˜í™”ëœ íƒ€ì…

function fetchFile<List extends URLList>(urls: List, key: keyof List) {
  return fetch(urls[key]).then((res) => res.json());
}
```
- ì´ì œ fetchFileì€ ë‹¤ìŒì²˜ëŸ¼ í˜¸ì¶œí•´ì•¼ í•¨:

```typescript
fetchFile(languages, "de"); // OK
fetchFile(languages, "it"); // ì˜¤ë¥˜: "it"ì€ keyof Languages ì•„ë‹˜
```
- ListëŠ” URLListì˜ í•˜ìœ„ íƒ€ì…
- keyëŠ” Listì˜ ì‹¤ì œ í‚¤ ì¤‘ í•˜ë‚˜ (keyof List)
  â†’ ì²« ë²ˆì§¸ ì¸ìì™€ ë‘ ë²ˆì§¸ ì¸ìì˜ íƒ€ì… ê´€ê³„ê°€ ëª…ì‹œì ìœ¼ë¡œ ì—°ê²°ë¨
- 
ğŸ” ì—¬ëŸ¬ key ë¡œ ì‘ì—…í•  ê²½ìš°
```typescript 
function fetchFiles<List extends URLList, Keys extends keyof List>(
  urls: List,
  keys: Keys[] //Keysê°€ "de" | "fr"ì´ë¼ë©´, Keys[]ëŠ” "de" ë˜ëŠ” "fr"ë§Œ ë‹´ì„ ìˆ˜ ìˆëŠ” ë°°ì—´
) {
  const els = keys.map((el) =>
    fetch(urls[el])
      .then((res) => res.json())
      .then((data) => {
        const entry: [Keys, any] = [el, data];
        return entry;
      })
  );
  return els;
}

fetchFiles(languages, ["de", "fr"]); // âœ… OK
fetchFiles(languages, ["de", "it"]); // âŒ "it"ì´ ì—†ìœ¼ë¯€ë¡œ ì˜¤ë¥˜

```
- 2ê°œì˜ ì œë„¤ë¦­ ì‚¬ìš©  â†’ ì´ì œ ì „ë‹¬í•œ í‚¤ ë¦¬ìŠ¤íŠ¸ê°€ Languagesì˜ ë¶€ë¶„ì§‘í•©ì¸ì§€ ëª…í™•íˆ ì²´í¬ë¨



## 4.3 anyì™€ unknown ì œê±°í•˜ê¸°
ğŸ’¡ ë¬¸ì œ
ë‹¤ìŒê³¼ ê°™ì€ identity í•¨ìˆ˜ëŠ” ì–´ë–¤ ê°’ì„ ë°›ì•„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” ë‹¨ìˆœí•œ êµ¬ì¡°ì§€ë§Œ,
anyë‚˜ unknownì„ ì“°ë©´ íƒ€ì… ì •ë³´ê°€ ì†Œì‹¤ë¨:
```typescript
function identity(value: any): any {
  return value;
}
```
```typescript
function identity(value: unknown): unknown {
  return value;
}
```
```typescript
const a = identity("hello"); // a: any ë˜ëŠ” unknown â†’ êµ¬ì²´ì ì¸ íƒ€ì… ì •ë³´ ì—†ìŒ

```
âœ… í•´ê²°: ì œë„¤ë¦­ ì‚¬ìš©
```typescript
function identity<T>(value: T): T {
  return value;
}

```
- ì´ì œ í˜¸ì¶œ ì‹œì ì— Tê°€ ì–´ë–¤ íƒ€ì…ì¸ì§€ ìë™ìœ¼ë¡œ ì¶”ë¡ ë¨:

```typescript
const a = identity("hello"); // a: string
const b = identity(123);     // b: number
const c = identity({ x: 1 }); // c: { x: number }

```

ğŸ“Œ constì™€ íƒ€ì… ì¶”ë¡ ì˜ ì°¨ì´

```typescript
let x = identity("hello");  // x: string
const y = identity("hello"); // y: "hello"

```
ë°©ì‹	         ìœ ì—°ì„±	      íƒ€ì… ë³´ì¡´	        ì•ˆì „ì„±
any	        ë§¤ìš° ë†’ìŒ	      ì—†ìŒ	      ë‚®ìŒ (ê²€ì‚¬ X)
unknown	    ë†’ìŒ	ì—†ìŒ	      ë†’ìŒ      (ì‚¬ìš© ì „ ê²€ì‚¬ í•„ìš”)
generic	      ë†’ìŒ	        ìˆìŒ	           ë†’ìŒ

âœ… ì‹¤ì œ í™œìš© ì˜ˆì‹œ â€“ íŠœí”Œ ìƒì„± í•¨ìˆ˜
unknownìœ¼ë¡œ êµ¬í˜„ ì‹œ:
```typescript
function pair(a: unknown, b: unknown): [unknown, unknown] {
 return [a, b];
}

```
```typescript
const result = pair(1, "a"); // result: [unknown, unknown]

```
ì œë„¤ë¦­ìœ¼ë¡œ êµ¬í˜„ ì‹œ:
```typescript
function pair<T, U>(a: T, b: U): [T, U] {
  return [a, b];
}

```
```typescript
const result = pair(1, "a"); // result: [number, string]

```
â†’ íƒ€ì…ì´ ì‚´ì•„ìˆê³ , ì´í›„ íƒ€ì… ì¶”ë¡ ê³¼ íƒ€ì… ê°€ë“œì—ì„œë„ í™œìš© ê°€ëŠ¥

- ì–¸ì œ ì œë„¤ë¦­ì„ ì“°ë‚˜?
  - ë°˜í™˜ íƒ€ì…ì´ ì…ë ¥ íƒ€ì…ì— ì˜ì¡´í•  ë•Œ
  - ê°™ì€ íƒ€ì…ë¼ë¦¬ì˜ ê´€ê³„ë¥¼ ë³´ì¥í•˜ê³  ì‹¶ì„ ë•Œ
  - ë‹¤ì–‘í•œ íƒ€ì…ì„ í—ˆìš©í•˜ë˜, íƒ€ì… ì •ë³´ë¥¼ ìƒê³  ì‹¶ì§€ ì•Šì„ ë•Œ

## 4.4 ì œë„¤ë¦­ ì¸ìŠ¤í„´ìŠ¤í™” ì´í•´í•˜ê¸°

**ì œë„¤ë¦­ íƒ€ì… ì¹˜í™˜(Generic Instantiation) ì œëŒ€ë¡œ ì´í•´í•˜ê¸°**

---

### âœ… í•µì‹¬ ê°œë…

- ì œë„¤ë¦­ íƒ€ì…ì€ **ì‚¬ìš© ì‹œì ì— êµ¬ì²´ì ì¸ íƒ€ì…ìœ¼ë¡œ ì¹˜í™˜(instantiated)**ë¨.
- ì œì•½ ì¡°ê±´(`extends`)ì´ ìˆë”ë¼ë„, ì¹˜í™˜ë˜ëŠ” íƒ€ì…ì€ ê·¸ ì œì•½ì˜ **í•˜ìœ„ íƒ€ì…(subtype)**ì´ ë  ìˆ˜ ìˆìŒ.
- ë¬¸ì œëŠ”, ìš°ë¦¬ê°€ ê¸°ëŒ€í•œ íƒ€ì…ë³´ë‹¤ ë” ë§ì€ ì†ì„±ì„ ê°€ì§„ **í•˜ìœ„ íƒ€ì…ì´ ë“¤ì–´ì˜¬ ìˆ˜ë„ ìˆë‹¤ëŠ” ì **.
- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì´ëŸ° ìƒí™©ì„ **ì •í™•í•˜ê²Œ ê²½ê³ í•´ì¤Œ**.

---

### â— ë¬¸ì œ ìƒí™©: ì¡°ê±´ ë¶„ê¸° + ì œë„¤ë¦­ ë°˜í™˜

```ts

//ë‹¨ì¼ í•„í„° ê·œì¹™ (ì˜ˆ: age > 30)
type FilterRule = {
  field: string;
  operator: string;
  value: any;
};

//ë³µí•© í•„í„° - ì—¬ëŸ¬ê°œì˜ FilterRuleì„ and ë˜ëŠ” orë¡œ ì¡°í•©
type CombinatorialFilter = {
  combinator: "and" | "or";
  rules: FilterRule[];
};

// ì²´ì¸í•„í„° - ë³µí•©í•„í„°(CombinatorialFilter) ê³¼ ë‹¨ì¼ì¡°ê±´(FilterRule)ì„ ì—¬ëŸ¬ê°œ ì—°ê²°
type ChainedFilter = {
  rules: (CombinatorialFilter | FilterRule)[];
};


type Filter = CombinatorialFilter | ChainedFilter;
```

ìš°ë¦¬ëŠ” `Filter`ë¥¼ ë°›ì•„ **ì¡°ê±´ì— ë”°ë¼ ì´ˆê¸°í™”ëœ ìƒˆë¡œìš´ Filter ê°ì²´**ë¥¼ ë°˜í™˜í•˜ê³ ì í•¨:

```ts
function reset(filter: Filter): Filter {
  //ë³µí•©í•„í„°
  if ("combinator" in filter) {
    return { combinator: "and", rules: [] };
  }
  //ì²´ì¸í•„í„°
  return { rules: [] };
}
```

### ğŸ§¨ ë¬¸ì œ

- ë°˜í™˜ íƒ€ì…ì´ í•­ìƒ `Filter`ì´ë¯€ë¡œ, **ì…ë ¥ íƒ€ì…ê³¼ ë¬´ê´€í•˜ê²Œ ë„“ì€ íƒ€ì…ì´ ë°˜í™˜**ë¨.
- ì˜ˆë¥¼ ë“¤ì–´ `CombinatorialFilter`ë¥¼ ë„˜ê²¼ì§€ë§Œ ë°˜í™˜ê°’ íƒ€ì…ì€ ê·¸ëƒ¥ `Filter`.

---

### âœ… í•´ê²° ì‹œë„ 1: ì œë„¤ë¦­ ë„ì…

```ts
function reset<F extends Filter>(filter: F): F {
  if ("combinator" in filter) {
    return { combinator: "and", rules: [] }; // âŒ íƒ€ì… ì˜¤ë¥˜ ë°œìƒ
  }
  return { rules: [] }; // âŒ ë§ˆì°¬ê°€ì§€ë¡œ ì˜¤ë¥˜ ë°œìƒ
}
```

#### â— ì—ëŸ¬ ì´ìœ 

- ë°˜í™˜ ê°’ì´ `F`ì˜ **ì œì•½ ì¡°ê±´(Filter)**ì—ëŠ” ë§ì§€ë§Œ,  
  `F`ëŠ” ê·¸ë³´ë‹¤ **ë” êµ¬ì²´ì ì¸ í•˜ìœ„ íƒ€ì…ì¼ ìˆ˜ë„ ìˆìŒ**.
- ì¦‰, `F`ëŠ” ì¶”ê°€ ì†ì„±ì„ ê°€ì§„ íƒ€ì…ì¼ ìˆ˜ë„ ìˆëŠ”ë°, ë°˜í™˜ ê°ì²´ëŠ” ê·¸ê±¸ í¬í•¨í•˜ì§€ ì•ŠìŒ â†’ **íƒ€ì… ë¶ˆì¼ì¹˜**

```ts
const result = reset({
  combinator: "and",
  rules: [],
  evaluated: true,
  result: false,
});
```

ì´ ê²½ìš° `F`ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì¶”ë¡ ë¨:

```ts
{
  combinator: "and";
  rules: FilterRule[];
  evaluated: boolean;
  result: boolean;
}
```

í•˜ì§€ë§Œ `reset` í•¨ìˆ˜ëŠ” `evaluated`, `result`ë¥¼ í¬í•¨í•˜ì§€ ì•ŠìŒ â†’ íƒ€ì… ë¶ˆì¼ì¹˜

---

### âœ… í•´ê²° ì‹œë„ 2: **ì…ë ¥ ê°ì²´ë¥¼ ë³µì‚¬í•´ì„œ ë°˜í™˜**

```ts
function reset<F extends Filter>(filter: F): F {
  const result = { ...filter }; // F íƒ€ì… ìœ ì§€
  result.rules = [];            // í•„ìš”í•œ ê°’ë§Œ ë³€ê²½
  if ("combinator" in result) {
    result.combinator = "and";
  }
  return result;
}
```

âœ” ì´ ë°©ì‹ì€ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ í—ˆìš©í•¨. ì™œëƒí•˜ë©´:

- ë°˜í™˜ ê°ì²´ëŠ” ì—¬ì „íˆ `F` íƒ€ì… (ì…ë ¥ ê·¸ëŒ€ë¡œ ë³µì‚¬)
- í•„ìš”í•œ ì†ì„±ë§Œ ë³€ê²½ â†’ íƒ€ì… ì•ˆì •ì„± ìœ ì§€

---

### ğŸŒ³ ë˜ ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤: íŠ¸ë¦¬(Tree) íƒ€ì… ìƒì„±

```ts
type TreeItem = {
  id: string;
  children: TreeItem[];
  collapsed?: boolean;
};
```

#### ë¬¸ì œ: íŠ¸ë¦¬ ë£¨íŠ¸ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜

```ts

function createRootItem<T extends TreeItem>(): T {
  return {
    id: "root",
    children: [],
  };
}

```
ğŸ”º ì˜¤ë¥˜ ë°œìƒ: TëŠ” TreeItemë³´ë‹¤ ë” ë§ì€ ì†ì„±ì„ ê°€ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—,
í˜„ì¬ ë°˜í™˜ ê°’ì´ Të¥¼ ë§Œì¡±í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ.



--------------------------------

### âœ… í•´ê²°: ì œë„¤ë¦­ ì œê±°

```ts
function createRootItem(): TreeItem {
  return {
    id: "root",
    children: [],
  };
}
```

â†’ ì´ì œ ë°˜í™˜ íƒ€ì…ì€ ëª…í™•í•˜ê²Œ `TreeItem`, ì˜¤ë¥˜ ì—†ìŒ.

---

### â— í•˜ì§€ë§Œ ë˜ ë‹¤ë¥¸ ë¬¸ì œ: ìì‹ì˜ ì„¸ë¶€ íƒ€ì…ì„ ë³´ì¡´í•˜ê³  ì‹¶ë‹¤ë©´?

```ts
function attachToRoot(children: TreeItem[]): TreeItem {
  return {
    id: "root",
    children,
  };
}
```

#### ë¬¸ì œì 

```ts
attachToRoot([
  { id: "child", children: [], collapsed: false, marked: true },
]);
```

- ìì‹ ê°ì²´ì— `marked` ê°™ì€ ì¶”ê°€ ì†ì„±ì´ ìˆë”ë¼ë„, ë°˜í™˜ê°’ì˜ íƒ€ì…ì€ **TreeItem**ìœ¼ë¡œ ì œí•œë¨
- ì¦‰, ìì‹ì— ìˆëŠ” ì¶”ê°€ ì •ë³´ê°€ **íƒ€ì… ì •ë³´ë¡œ ë³´ì¡´ë˜ì§€ ì•ŠìŒ**

---

### âœ… í•´ê²°: TreeItemì„ ì œë„¤ë¦­ íƒ€ì…ìœ¼ë¡œ ì¼ë°˜í™”

```ts
type BaseTreeItem = {
  id: string;
  children: BaseTreeItem[];
};

type TreeItem<Child extends TreeItem = BaseTreeItem> = {
  id: string;
  children: Child[];
  collapsed?: boolean;
};
```

#### âœ” ê°œì„ ëœ í•¨ìˆ˜

```ts
function attachToRoot<T extends TreeItem>(children: T[]): TreeItem<T> {
  return {
    id: "root",
    children,
  };
}
```

#### ê²°ê³¼

```ts
const root = attachToRoot([
  {
    id: "child",
    children: [],
    collapsed: false,
    marked: true,
  },
]);

// rootì˜ íƒ€ì…:
// TreeItem<{
//   id: string;
//   children: never[];
//   collapsed: boolean;
//   marked: boolean;
// }>
```

**â†’ ìì‹ ê°ì²´ì˜ íƒ€ì… ì •ë³´(marked ë“±)ê°€ ë³´ì¡´ë¨**

---

### ğŸ“Œ ìš”ì•½

| ê°œë… | ì„¤ëª… |
|------|------|
| ì œë„¤ë¦­ ì¹˜í™˜ | ì‚¬ìš© ì‹œì ì—ì„œ ì‹¤ì œ íƒ€ì…ìœ¼ë¡œ ëŒ€ì²´ë¨ |
| ì˜¤ë¥˜ ì›ì¸ | ë°˜í™˜ ê°ì²´ê°€ ì œë„¤ë¦­ íƒ€ì…ì˜ í•˜ìœ„ íƒ€ì…ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŒ |
| í•´ê²° 1 | ì…ë ¥ ê°ì²´ ë³µì‚¬ í›„ ìˆ˜ì • |
| í•´ê²° 2 | ì œë„¤ë¦­ ì œê±° ë˜ëŠ” ëª…í™•í•œ íƒ€ì… êµ¬ì¡° ì„¤ê³„ |
| ì‘ìš© | Tree êµ¬ì¡°ì— ì œë„¤ë¦­ì„ ë„ì…í•´ í•˜ìœ„ íƒ€ì… ì •ë³´ ìœ ì§€ |

---

### 4.5 ìƒˆ ê°ì²´ í˜•ì‹ ìƒì„±í•˜ê¸°(ê¸°ì¡´ íƒ€ì…ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ê°ì²´ íƒ€ì… ìƒì„±í•˜ê¸°)
âœ… í•µì‹¬ ê°œë…
ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì–´ë–¤ íƒ€ì…ì€ ë°ì´í„° ëª¨ë¸ê³¼ ì§ì ‘ ì—°ê²°ë˜ì–´ ìˆìŒ.
ëª¨ë¸ì´ ë°”ë€Œë©´ íƒ€ì…ë„ ì¼ì¼ì´ ìˆ˜ì •í•´ì•¼ í•˜ë©°, ì´ëŠ” ì¤‘ë³µê³¼ ìœ ì§€ë³´ìˆ˜ ë¹„ìš© ì¦ê°€ë¡œ ì´ì–´ì§.
TypeScriptì˜ Mapped Typesë¥¼ ì´ìš©í•˜ë©´ ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ íƒ€ì…ì„ ìƒì„±í•  ìˆ˜ ìˆìŒ.

ğŸ§¸ ì˜ˆì‹œ: ì¥ë‚œê° ë°ì´í„° ëª¨ë¸
```typescript
type ToyBase = {
  name: string;
  description: string;
  minimumAge: number;
};

type BoardGame = ToyBase & {
  kind: "boardgame";
  players: number;
};

type Puzzle = ToyBase & {
  kind: "puzzle";
  pieces: number;
};

type Doll = ToyBase & {
  kind: "doll";
  material: "plush" | "plastic";
};

type Toy = BoardGame | Puzzle | Doll;

```
### ëª©í‘œ: ì¥ë‚œê°ì„ kind ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜í•´ì„œ ê°ì²´ë¡œ ë¬¶ê¸°
### ë°©ë²• 1. ìˆ˜ë™ìœ¼ë¡œ ëª…ì‹œì  íƒ€ì… ì„ ì–¸
```typescript
type GroupedToys = {
  boardgame: Toy[];
  puzzle: Toy[];
  doll: Toy[];
};
```


```typescript
function groupToys(toys: Toy[]): GroupedToys {
  const groups: GroupedToys = {
    boardgame: [],
    puzzle: [],
    doll: [],
  };

  for (const toy of toys) {
    groups[toy.kind].push(toy); // toy.kindê°€ í‚¤ë¡œ ì‚¬ìš©ë¨
  }

  return groups;
}
```
- ì´ ë°©ì‹ì€ ì§ê´€ì ì´ê³  ì•ˆì „í•˜ì§€ë§Œ, Toy ì¢…ë¥˜ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ GroupedToysë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•¨.

```typescript 
type Bricks = ToyBase & {
  kind: "bricks";
  pieces: number;
  brand: string;
};

type Toy = BoardGame | Puzzle | Doll | Bricks;

groups[toy.kind].push(toy);
// âŒ TS ì˜¤ë¥˜: 'bricks'ëŠ” GroupedToysì˜ í‚¤ê°€ ì•„ë‹˜
```
- ì´ì œ GroupedToys íƒ€ì…ì€ "bricks"ì— ëŒ€í•´ ì•Œì§€ ëª»í•˜ë¯€ë¡œ ì˜¤ë¥˜ ë°œìƒ:

### ë°©ë²• 2.Toy["kind"]ë¥¼ ì´ìš©í•´ì„œ ë™ì ìœ¼ë¡œ ìƒì„± (Mapped Type)

```typescript
type GroupedToys = {
  [k in Toy["kind"]]?: Toy[]; // â­â­â­k ëŠ” "ë°˜ë³µ ë³€ìˆ˜" ê°™ì€ ì—­í• â­â­â­
};



// type GroupedToys = {
//   boardgame?: Toy[];
//   puzzle?: Toy[];
//   doll?: Toy[];
//   bricks?: Toy[];
// };

```
- Toy["kind"]
  - ğŸ‘‰ "boardgame" | "puzzle" | "doll" | "bricks"
  - ìœ ë‹ˆì–¸ íƒ€ì…. ê° Toy íƒ€ì…ë§ˆë‹¤ kind í”„ë¡œí¼í‹°ì˜ ë¦¬í„°ëŸ´ ê°’ì„ ë½‘ì€ ê²ƒì´ë‹¤.

- [k in Toy["kind"]]?: Toy[]
  - ğŸ‘‰ këŠ” "boardgame", "puzzle", "doll", "bricks"ë¥¼ ë°˜ë³µí•˜ëŠ” ë§¤í•‘ ë³€ìˆ˜ (ì¼ì¢…ì˜ forë¬¸ ë³€ìˆ˜ì²˜ëŸ¼ ë™ì‘).
  - ğŸ‘‰ ê° kì— ëŒ€í•´ Toy[]ë¥¼ ê°’ìœ¼ë¡œ ê°–ëŠ” í”„ë¡œí¼í‹°ë¥¼ ë§Œë“¤ë˜, ì„ íƒì (?) ì†ì„±ìœ¼ë¡œ ë§Œë“ ë‹¤.
- Mapped Typeì„ ì´ìš©í•´ ê° kind ê°’ì„ ê°ì²´ì˜ í‚¤ë¡œ ì‚¬ìš©

---
- Mapped Type êµ¬ë¬¸
  ```typescript
  type MyMappedType = {
    [K in SomeUnionType]: ValueType;
  };
  
  ```
 - ì´ ì „ì²´ ë¬¸ë²•ì´ Mapped Type (ë§¤í•‘ëœ íƒ€ì…) ì´ê³ ,  ê·¸ ì•ˆì—ì„œ inì€ forë¬¸ì²˜ëŸ¼ ë°˜ë³µí•˜ëŠ” ì—­í• ì„ í•œë‹¤.
 - KëŠ” ë§¤í•‘ ë³€ìˆ˜ (key), SomeUnionTypeì€ ë°˜ë³µí•  ê°’ë“¤ì˜ ìœ ë‹ˆì–¸ íƒ€ì….

 ```typescript
  type Keys = "a" | "b" | "c";
  
  type MyMap = {
    [K in Keys]: number;
  };
  // ê²°ê³¼:
  // type MyMap = {
  //   a: number;
  //   b: number;
  //   c: number;
  // }
    
```
---

--- 

cf. ë°©ë²• 1ì´ë“  ë°©ë²• 2ì´ë“  í•¨ìˆ˜ëŠ” ë™ì¼í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
 
```typescript
function groupToys(toys: Toy[]): GroupedToys {
  const groups: GroupedToys = {};

  for (const toy of toys) {
    groups[toy.kind] = groups[toy.kind] ?? [];
    groups[toy.kind]!.push(toy);
  }

  return groups;
}
```
- ?? []: ì•„ì§ í•´ë‹¹ ê·¸ë£¹ì´ ì—†ë‹¤ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”
- !: TypeScriptê°€ undefinedê°€ ì•„ë‹˜ì„ í™•ì‹ í•˜ë„ë¡ ëª…ì‹œ
---

### (í™•ì¥) ì¼ë°˜í™”: ë‹¤ë¥¸ ë°ì´í„°ë„ kindì²˜ëŸ¼ ë¶„ë¥˜í•˜ê³  ì‹¶ì„ ë•Œ
 ì˜ˆ: Product, User, Post ë“±ë„ íŠ¹ì • í‚¤ ê¸°ì¤€ìœ¼ë¡œ ë¬¶ê³  ì‹¶ë‹¤ë©´?
ëª©í‘œ
```typescript
type Group<T, K extends keyof T> = {
  [P in T[K]]: T[];
};
```
í•˜ì§€ë§Œ ì´ê±´ ë°”ë¡œ ì˜¤ë¥˜ ë°œìƒí•¨:
Type 'T[K]' is not assignable to type 'string | number | symbol'.
ì™œëƒí•˜ë©´ ê°ì²´ì˜ í‚¤ëŠ” ë¬¸ìì—´/ìˆ«ì/ì‹¬ë³¼ì´ì–´ì•¼ í•˜ëŠ”ë°,
T[K]ê°€ ê·¸ëŸ° í‚¤ íƒ€ì…ì´ë¼ëŠ” ë³´ì¥ì´ ì—†ìŒ.

âœ… í•´ê²° ë°©ë²• 1: Record<string, any>ë¡œ ì œì•½í•˜ê¸°

```typescript
type Group<
  Collection extends Record<string, any>,
  Selector extends keyof Collection
> = {
  [P in Collection[Selector]]: Collection[];
};
```
- Record<string, any>ëŠ” í‚¤ê°€ stringì¸ ì„ì˜ ê°ì²´
- ì´ì œ Collection[Selector]ê°€ í‚¤ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤ê³  ê°„ì£¼ë¨

âœ… í•´ê²° ë°©ë²• 2: ì¡°ê±´ë¶€ íƒ€ì…ìœ¼ë¡œ stringë§Œ í•„í„°ë§, í‚¤ íƒ€ì… ë³´ì¥

```typescript
type Group<Collection, Selector extends keyof Collection> = {
  [P in Collection[Selector] extends string
    ? Collection[Selector]
    : never]: Collection[];
};

```
- Collection[Selector]ê°€ stringì´ë©´ í‚¤ë¡œ ì‚¬ìš©, ì•„ë‹ˆë¼ë©´ ì œê±° (never)
- ì¢€ ë” ì•ˆì „í•œ íƒ€ì… ì„¤ê³„ê°€ ê°€ëŠ¥
---

âœ¨ Partial<Group<...>>ë¡œ Optional í‚¤ ì§€ì •

```typescript
type GroupedToys = Partial<Group<Toy, "kind">>;
```

ê·¸ë£¹ í‚¤ë“¤ì€ í•­ìƒ ì¡´ì¬í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ Partialë¡œ ê°ì‹¸ optional ì²˜ë¦¬
ëª¨ë¸ì´ ë°”ë€Œë©´ Toyë§Œ ìˆ˜ì •í•˜ë©´ ë¨ â†’ ìœ ì§€ë³´ìˆ˜ ì‰¬ì›Œì§

---
ğŸ§  ë³´ì¡° íƒ€ì…: Recordì™€ Partial
```typescript
type Record<K extends keyof any, T> = {
  [P in K]: T;
};

type Partial<T> = {
  [P in keyof T]?: T[P];
};
```
---

ğŸ“Œ ì •ë¦¬
ê°œë…	         |            ì„¤ëª…
Mapped Type	 | ê¸°ì¡´ íƒ€ì…ì—ì„œ ìƒˆë¡œìš´ ì†ì„± ì§‘í•©ì„ ìƒì„±
Toy["kind"]  | 	ìœ ë‹ˆì–¸ íƒ€ì…ìœ¼ë¡œ í‚¤ ì¶”ì¶œ
[K in U]	   | ê° ìœ ë‹ˆì–¸ íƒ€ì…ì„ í‚¤ë¡œ ë³€í™˜
Partial<T>	 | ëª¨ë“  ì†ì„±ì„ ì„ íƒì (Optional)ë¡œ ë§Œë“¦
Record<K, T> |	íŠ¹ì • í‚¤ ì§‘í•©ì„ ê¸°ë°˜ìœ¼ë¡œ ê°ì²´ íƒ€ì… ìƒì„±

âœ… ì „ì²´ íë¦„ ìš”ì•½
ëª¨ë¸ íƒ€ì…ì´ ë°”ë€Œë©´ ìˆ˜ë™ìœ¼ë¡œ ê´€ë ¨ íƒ€ì…ì„ ìˆ˜ì •í•´ì•¼ í•¨ â†’ ì˜¤ë¥˜ ìœ ë°œ
Mapped Typeê³¼ ìœ í‹¸ë¦¬í‹° íƒ€ì…ì„ í™œìš©í•˜ë©´ ìë™í™” ê°€ëŠ¥
Group<T, K> íƒ€ì…ì€ ë²”ìš©ì ì´ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ íƒ€ì… ìƒì„± ë°©ì‹ ì œê³µ


## 4.6 ì–´ì„œì…˜ ì‹œê·¸ë‹ˆì²˜ë¡œ ê°ì²´ ë³€ê²½í•˜ê¸°

### 1. ë¬¸ì œ ìƒí™©

- JavaScriptì—ì„œëŠ” ê°ì²´ì— **ë™ì ìœ¼ë¡œ ì†ì„± ì¶”ê°€**ê°€ ê°€ëŠ¥í•˜ë‹¤.
- ì•„ë˜ ì½”ë“œëŠ” JavaScriptì—ì„œëŠ” ì•„ë¬´ ë¬¸ì œ ì—†ë‹¤:

```ts
function check(person: any) {
  person.checked = true;
}

const person = {
  name: "Stefan",
  age: 27,
};

check(person);
console.log(person.checked); // true
```

- í•˜ì§€ë§Œ TypeScriptì—ì„œëŠ” `person` ê°ì²´ì˜ íƒ€ì…ì´ `{ name: string; age: number }`ì´ê¸° ë•Œë¬¸ì—,
  `person.checked`ì— ì ‘ê·¼í•˜ë©´ **ì˜¤ë¥˜**ê°€ ë°œìƒí•œë‹¤.

---

### 2. ê¸°ì¡´ í•´ê²° ë°©ë²•

#### (1) ìˆ˜ë™ íƒ€ì… ë‹¨ì–¸ ì‚¬ìš©
```ts
(person as typeof person & { checked: boolean }).checked = true;
```

- ì˜ë¯¸: `person` íƒ€ì…ì— `checked: boolean` ì†ì„±ì´ ìˆë‹¤ê³  ì¼ì‹œì ìœ¼ë¡œ "ë§ë¶™ì¸ë‹¤".
- ë¬¸ì œì : ë§¤ë²ˆ ì´ëŸ° íƒ€ì… ë‹¨ì–¸ì„ ë°˜ë³µí•´ì•¼ í•˜ë©° **ì›ë˜ íƒ€ì… ì •ë³´ëŠ” ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤**.

#### (2) ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œ ì‚¬ìš©
```ts
function check<T>(obj: T): obj is T & { checked: true } {
  (obj as T & { checked: boolean }).checked = true;
  return true;
}

const person = { name: "Stefan", age: 27 };

if (check(person)) {
  person.checked; // ì •ìƒ ì¸ì‹
}
```

- ì¥ì : `if (check(...))` ë¬¸ ì•ˆì—ì„œëŠ” `checked`ê°€ íƒ€ì…ìœ¼ë¡œ ì¸ì‹ëœë‹¤.
- ë‹¨ì : í•­ìƒ `if` ë¬¸ìœ¼ë¡œ ê°ì‹¸ì•¼ í•˜ë©°, `check` í•¨ìˆ˜ê°€ `true`ë¥¼ ë°˜í™˜í•´ì•¼ë§Œ ì˜ë¯¸ê°€ ìƒê¸´ë‹¤.

---

### 3. í•´ê²°ì±…: Assertion Signature ì‚¬ìš©

#### ì •ì˜
- `asserts` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ TypeScriptì—ê²Œ "ì´ê±´ trueë¼ê³  ë¯¿ì–´ë„ ë¼"ë¼ê³  ì•Œë ¤ì¤€ë‹¤.
- ì¡°ê±´ì´ falseë©´ `throw`ë¡œ ëë‚˜ê³ , trueë©´ íƒ€ì…ì´ í™•ì •ëœë‹¤.

#### ê¸°ë³¸ ì˜ˆì œ
```ts
function assert(condition: any, msg?: string): asserts condition {
  if (!condition) {
    throw new Error(msg);
  }
}

function yell(str: any) {
  assert(typeof str === "string");
  return str.toUpperCase(); // strì€ stringìœ¼ë¡œ ì¶”ë¡ ë¨
}
```

- `asserts condition` â†’ ì¡°ê±´ì´ trueë¼ë©´ ì´í›„ ì½”ë“œì—ì„œëŠ” `condition`ì´ trueì¸ ê²ƒìœ¼ë¡œ ê°„ì£¼
- ì¡°ê±´ì´ ê±°ì§“ì¼ ê²½ìš° `throw`ë¡œ í•¨ìˆ˜ê°€ ì¢…ë£Œë˜ë¯€ë¡œ ë…¼ë¦¬ì ìœ¼ë¡œ ì•ˆì „

---


###  âœ… `asserts` ì‹œê·¸ë‹ˆì²˜ í•¨ìˆ˜ì—ì„œ `throw`ëŠ” **í•„ìˆ˜**

- `asserts` ì‹œê·¸ë‹ˆì²˜ í•¨ìˆ˜ëŠ” **ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ ì¢…ë£Œ**ë¥¼ ë³´ì¥í•´ì•¼ í•˜ë¯€ë¡œ `throw`ëŠ” ì‚¬ì‹¤ìƒ **í•„ìˆ˜**
- ê·¸ë˜ì•¼ë§Œ TypeScriptê°€ **ì•ˆì „í•˜ê²Œ íƒ€ì…ì„ í™•ì •**í•  ìˆ˜ ìˆìŒ

#### 1. ì´ìœ 

- `asserts`ëŠ” **íƒ€ì…ì„ ê°•ì œ í™•ì •**ì‹œì¼œì£¼ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
- ì¡°ê±´ì´ `false`ì¼ ë•Œ í”„ë¡œê·¸ë¨ì„ **ì¦‰ì‹œ ë©ˆì¶°ì•¼** íƒ€ì… ì•ˆì „ì„ ë³´ì¥í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—,
- `throw`ë¥¼ ì‚¬ìš©í•´ì„œ **í•¨ìˆ˜ë¥¼ ì¤‘ë‹¨ (never)** ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.

#### 2. í˜•íƒœ

```ts
function assert(condition: any): asserts condition {
  if (!condition) {
    throw new Error("ì¡°ê±´ì´ falseì…ë‹ˆë‹¤");
  }
}
```

- `condition`ì´ falseë©´ â†’ **ë°˜ë“œì‹œ throwë¡œ ì¢…ë£Œ**
- ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ â†’ **íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ê·¸ ì•„ë˜ë¶€í„° conditionì´ trueì„ì„ í™•ì •**


#### 3. ë§Œì•½ `throw`ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´?

```ts
function assert(condition: any): asserts condition {
  if (!condition) {
    console.log("ì˜ëª»ëœ ê°’ì…ë‹ˆë‹¤"); // âŒ ì˜¤ë¥˜ ì•„ë‹˜, í•˜ì§€ë§Œ íƒ€ì… ë³´ì¥ì´ ì•ˆ ë¨
  }
}
```

- ì»´íŒŒì¼ì€ ë˜ì§€ë§Œ, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì´ `assert` í•¨ìˆ˜ê°€ **ì•ˆì „í•˜ì§€ ì•Šë‹¤ê³  íŒë‹¨**í•´ì„œ
- `condition`ì´ trueë¼ëŠ” ê±¸ **ë³´ì¥í•˜ì§€ ì•ŠìŒ**
- ì¦‰, `asserts` íš¨ê³¼ë¥¼ **ì–»ì„ ìˆ˜ ì—†ìŒ**

---

### 4. `asserts val is Type`ì—ì„œë„ ë§ˆì°¬ê°€ì§€

```ts
function assertString(val: any): asserts val is string {
  if (typeof val !== "string") {
    throw new Error("ë¬¸ìì—´ì´ ì•„ë‹™ë‹ˆë‹¤");
  }
}
```

â†’ `throw`ê°€ ì—†ìœ¼ë©´ `val is string`ì€ **ë³´ì¥ë˜ì§€ ì•ŠìŒ**

---

### 4. ì‚¬ìš©ì ì •ì˜ íƒ€ì… ë‹¨ì–¸ ì‹œê·¸ë‹ˆì²˜ ì‚¬ìš©

#### ìˆ«ì íƒ€ì… ê°•ì œ ì˜ˆì‹œ
```ts
function assertNumber(val: any): asserts val is number {
  if (typeof val !== "number") {
    throw Error("value is not a number");
  }
}

function add(x: unknown, y: unknown): number {
  assertNumber(x);
  assertNumber(y);
  return x + y; // xì™€ yëŠ” ì—¬ê¸°ì„œ numberë¡œ ì¸ì‹ë¨
}
```

---

### 5. ê°ì²´ ì†ì„± ì¶”ê°€ì—ë„ ì ìš© ê°€ëŠ¥

#### Assertion Signature ì‚¬ìš© ì˜ˆì œ
```ts
function check<T>(obj: T): asserts obj is T & { checked: true } {
  (obj as T & { checked: boolean }).checked = true;
}

const person = {
  name: "Stefan",
  age: 27,
};

check(person);

console.log(person.checked); // ì´ì œ íƒ€ì… ì¸ì‹ë¨!
```

- ë‹¨ í•œ ë²ˆì˜ `check()` í˜¸ì¶œë¡œ `person` ê°ì²´ëŠ” `checked: true` ì†ì„±ì„ **íƒ€ì…ìƒìœ¼ë¡œë„** ê°–ê²Œ ëœë‹¤.
- `if (check(...))` ê°™ì€ ì¡°ê±´ë¬¸ì´ **í•„ìš”í•˜ì§€ ì•ŠìŒ**
- **ê°ì²´ë¥¼ ìˆ˜ì •í•˜ëŠ” ë™ì‹œì— íƒ€ì…ë„ í•¨ê»˜ ìˆ˜ì •**í•  ìˆ˜ ìˆìŒ

---

### 6. ì •ë¦¬

| ë°©ì‹ | ì¥ì  | ë‹¨ì  |
|------|------|------|
| ìˆ˜ë™ ë‹¨ì–¸ `(as ...)` | ë‹¨ìˆœ, ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ | ë°˜ë³µì ì´ê³  ì›ë˜ íƒ€ì…ì€ ê·¸ëŒ€ë¡œ |
| íƒ€ì… ê°€ë“œ í•¨ìˆ˜ (`is ...`) | íƒ€ì… ì¡°ê±´ë¶€ ë¶„ê¸° ê°€ëŠ¥ | if ë¬¸ì´ í•„ìš”í•¨ |
| Assertion Signature (`asserts`) | íƒ€ì… ê°•ì œ í™•ì •, ì¡°ê±´ë¬¸ ì—†ì´ íƒ€ì… ìˆ˜ì • ê°€ëŠ¥ | TypeScript 3.7 ì´ìƒ í•„ìš” |

---
---

## 4.7 í˜•ìƒ‰ ë§µì„ ì´ìš©í•œ ë§¤í•‘ í˜•ì‹ ì‚¬ìš©í•˜ê¸° - Mapping Types with Type Maps
---
### 1. ë¬¸ì œ ìƒí™©

- HTML ìš”ì†Œë¥¼ ìƒì„±í•˜ëŠ” íŒ©í† ë¦¬ í•¨ìˆ˜ `createElement`ë¥¼ ë§Œë“¤ê³ ì í•¨
- íƒœê·¸ëª… `"a"`, `"div"`, `"video"` ë“±ì„ ë„˜ê¸°ë©´ í•´ë‹¹ HTML ìš”ì†Œ íƒ€ì…ì´ ë°˜í™˜ë˜ì–´ì•¼ í•¨
- ì¶”ê°€ë¡œ í•´ë‹¹ ìš”ì†Œì— ë§ëŠ” ì†ì„±ë„ ìë™ ì™„ì„±ë˜ê²Œ í•˜ê³  ì‹¶ìŒ

```ts
const a = createElement("a", { href: "https://fettblog.eu" });      // HTMLAnchorElement
const b = createElement("video", { src: "/movie.mp4", autoplay: true }); // HTMLVideoElement
const c = createElement("my-element");  // HTMLElement
```

---

### 2. í•´ê²° ì „ëµ

#### 1) íƒœê·¸ëª… â†’ íƒ€ì… ë§¤í•‘ì„ ìœ„í•œ íƒ€ì… ë§µ ìƒì„±
```ts
type AllElements = {
  a: HTMLAnchorElement;
  div: HTMLDivElement;
  video: HTMLVideoElement;
  // ... (ìƒëµ ê°€ëŠ¥)
};
```

#### 2) íƒ€ì… ë§µì˜ ì¸ë±ì‹±ì„ ì‚¬ìš©í•´ íƒ€ì… ì¶”ë¡ 
```ts
type A = AllElements["a"]; // HTMLAnchorElement
type AAndDiv = AllElements["a" | "div"]; // HTMLAnchorElement | HTMLDivElement
```

#### 3) createElement í•¨ìˆ˜ ì •ì˜
```ts
function createElement<T extends keyof AllElements>(tag: T): AllElements[T] {
  return document.createElement(tag as string) as AllElements[T];
}
```
- ì´ íƒ€ì… ë§µì„ ê¸°ë°˜ìœ¼ë¡œ, createElement í•¨ìˆ˜ì˜ íƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- ì´ í•¨ìˆ˜ëŠ” íƒœê·¸ ì´ë¦„ì„ ë°›ê³  â†’ document.createElement(tag)ë¡œ ìš”ì†Œë¥¼ ë§Œë“¤ë©°
- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ìƒì—ì„œëŠ” ì •í™•í•œ ìš”ì†Œ íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ëœë‹¤.
---

### 3. ì†ì„± ì„¤ì • ê¸°ëŠ¥ ì¶”ê°€

#### ë¬¸ì œì 
- HTML ìš”ì†Œì— ì†ì„±ì„ ì„¤ì •í•˜ê³  ì‹¶ì€ë°, ì†ì„± íƒ€ì…ì´ í•„ìˆ˜ë¼ ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥

#### í•´ê²° ë°©ë²•: `Partial<T>` í™œìš©
```ts
type Partial<T> = {
  [P in keyof T]?: T[P];
};
```

#### ì ìš© ì˜ˆ
```ts
function createElement<T extends keyof AllElements>(
  tag: T,
  props?: Partial<AllElements[T]>
): AllElements[T] {
  const elem = document.createElement(tag as string) as AllElements[T];
  return Object.assign(elem, props);
}
```
- Partial<AllElements[T]>ëŠ”?
  - ì´ ê°ì²´ì˜ ëª¨ë“  ì†ì„±ì„ ì„ íƒì (optional) ìœ¼ë¡œ ë°”ê¾¼ ê²ƒì…ë‹ˆë‹¤.
- AllElements["a"] â†’ HTMLAnchorElement
  ```javascript
  interface HTMLAnchorElement extends HTMLElement {
    href: string;
    target: string;
    download: string;
    rel: string;
    // ... ë‹¤ì–‘í•œ ì†ì„± ì¡´ì¬
  }
  ```
  ```typescript
    Partial<HTMLAnchorElement> =
    {
      href?: string;
      target?: string;
      download?: string;
      rel?: string;
      // ... ëª¨ë“  ì†ì„±ì´ ? ë¶™ì€ ìƒíƒœ
    }

    ```
  ```typescript
  //ì´ëŸ°ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
  createElement("a", {
      href: "https://example.com",
      target: "_blank"
  }); 
  ```
---

### 4. ì‚¬ìš© ì˜ˆ ë° íƒ€ì… ê²€ì¦

```ts
const a = createElement("a", { href: "https://fettblog.eu" }); // OK
const x = createElement("a", { src: "https://wrong.com" }); // ì˜¤ë¥˜: HTMLAnchorElementì—ëŠ” srcê°€ ì—†ìŒ
```

---

### 5. ëª¨ë“  HTML íƒœê·¸ ì»¤ë²„í•˜ê¸°
- AllElements íƒ€ì… ë§µì— ëª¨ë“  íƒœê·¸ë¥¼ ì •ì˜í•  ìˆ˜ ì—†ìŒ
- #### ë‚´ì¥ íƒ€ì… `HTMLElementTagNameMap` ì‚¬ìš©
```ts
function createElement<T extends keyof HTMLElementTagNameMap>(
  tag: T,
  props?: Partial<HTMLElementTagNameMap[T]>
): HTMLElementTagNameMap[T] {
  const elem = document.createElement(tag);
  return Object.assign(elem, props);
}
```

- `document.createElement()`ì— ë§ì¶° íƒ€ì… ìë™ ì—°ê²° ê°€ëŠ¥

---

### 6. ì»¤ìŠ¤í…€ ìš”ì†Œ(`my-element`)ë„ í—ˆìš©í•˜ë ¤ë©´?

#### ë°©ë²• 1: ì¸ë±ìŠ¤ ì‹œê·¸ë‹ˆì²˜ ì¶”ê°€
```ts
interface HTMLElementTagNameMap {
  [x: string]: HTMLUnknownElement;
}
```

#### ë°©ë²• 2: í…œí”Œë¦¿ ë¦¬í„°ëŸ´ íƒ€ì…ìœ¼ë¡œ ì›¹ ì»´í¬ë„ŒíŠ¸ë§Œ í—ˆìš©
```ts
type AllElements = HTMLElementTagNameMap & {
  [x in `${string}-${string}`]: HTMLElement;
};
```

```ts
const a = createElement("a", { href: "https://..." }); // OK
const b = createElement("my-element"); // OK
const c = createElement("invalid"); // ì˜¤ë¥˜: ëŒ€ì‹œ(-)ê°€ ì—†ìœ¼ë©´ ì›¹ ì»´í¬ë„ŒíŠ¸ ì•„ë‹˜
```

---

### 7. íƒ€ì… ë‹¨ì–¸ ì œê±°: í•¨ìˆ˜ ì˜¤ë²„ë¡œë“œ ì‚¬ìš©

```ts
function createElement<T extends keyof AllElements>(
  tag: T,
  props?: Partial<AllElements[T]>
): AllElements[T];

function createElement(
  tag: string,
  props?: Partial<HTMLElement>
): HTMLElement {
  const elem = document.createElement(tag);
  return Object.assign(elem, props);
}
```

- ì™¸ë¶€ì—ì„œ ì‚¬ìš©í•  ë•ŒëŠ” íƒ€ì… ì¶”ë¡ ê³¼ ìë™ì™„ì„±ì´ ì‘ë™
- ë‚´ë¶€ êµ¬í˜„ì€ `HTMLElement` ê¸°ì¤€ìœ¼ë¡œ ë‹¨ìˆœ ì²˜ë¦¬

---

### 8. ì •ë¦¬

| ê¸°ìˆ  | ì—­í•  |
|------|------|
| `type map (AllElements)` | íƒœê·¸ëª… â†’ ìš”ì†Œ íƒ€ì… ì—°ê²° |
| `Partial<T>` | ì†ì„± ì„ íƒì ìœ¼ë¡œ ë§Œë“¤ê¸° |
| `HTMLElementTagNameMap` | ë‚´ì¥ íƒœê·¸ëª…ê³¼ DOM íƒ€ì… ì—°ê²° |
| í…œí”Œë¦¿ ë¦¬í„°ëŸ´ íƒ€ì… | ì»¤ìŠ¤í…€ ìš”ì†Œëª… íŒ¨í„´ ì§€ì • (`my-tag`) |
| í•¨ìˆ˜ ì˜¤ë²„ë¡œë“œ | ì‚¬ìš©ìì—ê²Œ ì •í™•í•œ íƒ€ì… ì œê³µ + ë‚´ë¶€ëŠ” ìœ ì—°í•˜ê²Œ êµ¬í˜„ |

--- 

## 4.8 ThisTypeìœ¼ë¡œ ê°ì²´ì˜ this ì •ì˜í•˜ê¸°

### 1. ë¬¸ì œ ìƒí™©

Vue.js ìŠ¤íƒ€ì¼ì˜ êµ¬ì„± ê°ì²´(config object)ë¥¼ ë§Œë“¤ê³  ì‹¶ìŒ:

```ts
const instance = create({
  data() {
    return {
      firstName: "Stefan",
      lastName: "Baumgartner",
    };
  },
  computed: {
    fullName() {
      return this.firstName + " " + this.lastName;
    },
  },
  methods: {
    hi() {
      alert(this.fullName.toLowerCase());
    },
  },
});
```

#### ìš”êµ¬ ì‚¬í•­ ìš”ì•½

- `data()`ëŠ” ì´ˆê¸° ìƒíƒœë¥¼ ë°˜í™˜í•˜ë©°, **ë‹¤ë¥¸ ì†ì„±ì—ëŠ” ì ‘ê·¼ ë¶ˆê°€**
- `computed`ëŠ” `data`ì˜ ê°’ì„ **thisë¡œ ì ‘ê·¼** ê°€ëŠ¥
- `methods`ëŠ” `data + computed + methods`ë¥¼ **thisë¡œ ì ‘ê·¼** ê°€ëŠ¥

---

### 2. í•´ê²° ì „ëµ: `ThisType<T>` ì‚¬ìš©

#### `ThisType<T>`ë€?
- ê°ì²´ ë¦¬í„°ëŸ´ ë‚´ë¶€ì—ì„œ `this`ì˜ íƒ€ì…ì„ **ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •**í•  ìˆ˜ ìˆëŠ” ë‚´ì¥ íƒ€ì…
- ì„ ì–¸ì—ë§Œ ì‚¬ìš©, **ì§ì ‘ íƒ€ì…ìœ¼ë¡œ ì“°ëŠ” ê²Œ ì•„ë‹ˆë¼ ë³´ì¡°ìš© íƒ€ì…ì„**

---

### 3. ì „ì²´ íƒ€ì… êµ¬ì¡° ì •ì˜

#### (1) ê¸°ë³¸ í•¨ìˆ˜ ê°ì²´ íƒ€ì… ì •ì˜
```ts
type FnObj = Record<string, () => any>;
```

#### (2) í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ë§Œ ë½‘ì•„ë‚´ëŠ” ë§¤í•‘ íƒ€ì…
```ts
type MapFnToProp<T extends FnObj> = {
  [K in keyof T]: ReturnType<T[K]>;
};
```

---

### 4. êµ¬ì„± ê°ì²´ì˜ ì „ì²´ íƒ€ì… ì •ì˜

```ts
type Options<Data, Computed extends FnObj, Methods> = {
  data(this: {}): Data;
  computed?: Computed & ThisType<Data>;
  methods?: Methods & ThisType<Data & MapFnToProp<Computed> & Methods>;
};
```

| êµ¬ì„± í•­ëª© | `this`ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ëŒ€ìƒ |
|-----------|------------------------------|
| `data()` | ì•„ë¬´ê²ƒë„ ì—†ìŒ (`{}`) |
| `computed` | `data()`ì˜ ë°˜í™˜ê°’ |
| `methods` | `data + computed ê²°ê³¼ + methods ìì‹ ` |

---

### 5. create í•¨ìˆ˜ ì„ ì–¸

```ts
declare function create<Data, Computed extends FnObj, Methods>(
  options: Options<Data, Computed, Methods>
): any;
```

---

### 6. ì‚¬ìš© ì˜ˆ

```ts
const instance = create({
  data() {
    return {
      firstName: "Stefan",
      lastName: "Baumgartner",
    };
  },
  computed: {
    fullName() {
      return this.firstName + " " + this.lastName;
    },
  },
  methods: {
    hi() {
      alert(this.fullName.toLowerCase()); // computedë„ thisë¡œ ì ‘ê·¼ë¨
    },
  },
});
```

- `fullName()` ì•ˆì—ì„œëŠ” `this.firstName` ê°€ëŠ¥ â†’ `ThisType<Data>`
- `hi()` ì•ˆì—ì„œëŠ” `this.fullName`, `this.firstName` ëª¨ë‘ ê°€ëŠ¥  
  â†’ `ThisType<Data & computed ê²°ê³¼ & methods ìì‹ >`

---

### 7. ì •ë¦¬

| ê°œë… | ì„¤ëª… |
|------|------|
| `ThisType<T>` | ê°ì²´ ë‚´ `this`ì˜ íƒ€ì…ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì • |
| `data(this: {})` | dataì—ì„œ `this`ëŠ” ë¹ˆ ê°ì²´ |
| `computed: Computed & ThisType<Data>` | computedì—ì„œ `this`ëŠ” data ê°’ |
| `methods: Methods & ThisType<Data & computed ê°’ & methods>` | methodsì—ì„œëŠ” ëª¨ë“  ê°’ ì ‘ê·¼ ê°€ëŠ¥ |
| `MapFnToProp<T>` | computedì˜ ê²°ê³¼ë¥¼ ì†ì„±ì²˜ëŸ¼ ë‹¤ë£¨ê¸° ìœ„í•´ ë°˜í™˜ê°’ ì¶”ì¶œ |

---


## 4.9 ì œë„¤ë¦­ í˜•ì‹ ë§¤ê°œë³€ìˆ˜ì— const ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€í•˜ê¸°

### 1. ë¬¸ì œ ìƒí™©

```ts
const rtr = router([
  { path: "/", component: Main },
  { path: "/about", component: About },
]);

rtr.navigate("/faq"); // âŒ ì˜¤ë¥˜ê°€ ë‚˜ì§€ ì•ŠìŒ
```

- TypeScriptëŠ” ê°ì²´ ë¦¬í„°ëŸ´ì„ ë„˜ê¸°ë©´ ê·¸ ì•ˆì˜ ê°’ë“¤ì„ **ë„“ì€ íƒ€ì…(string)** ìœ¼ë¡œ ì¶”ë¡ 
- ê·¸ë˜ì„œ `navigate()`ì— **ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ë¡œ**ë„ í—ˆìš©ë¨

---

### 2. ëª©í‘œ

- `router()` í•¨ìˆ˜ì— ë„˜ê¸´ `path` ê°’ë“¤ì„ `"path"`ì˜ ìœ ë‹ˆì˜¨ íƒ€ì…ìœ¼ë¡œ ìœ ì§€í•˜ê³ 
- `navigate("/faq")` ê°™ì€ ì˜ëª»ëœ ê²½ë¡œëŠ” **ì»´íŒŒì¼ ì—ëŸ¬ë¡œ ë§‰ê³  ì‹¶ìŒ**

---

### 3. ì²˜ìŒ ì‹œë„: ì œë„¤ë¦­ `T` ì‚¬ìš©

```ts
function router<T extends Route>(routes: T[]) {
  return {
    navigate(path: T["path"]) {
      // ...
    },
  };
}
```

#### ë¬¸ì œ
- `T["path"]`ëŠ” `"path"` ì†ì„±ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ìœ ë‹ˆì˜¨ìœ¼ë¡œ ë³´ì´ì§€ë§Œ
- ê°ì²´ë‚˜ ë°°ì—´ì„ ë„˜ê¸¸ ê²½ìš° íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‚´ë¶€ ì†ì„±ì„ **ìë™ìœ¼ë¡œ widening (string)** ì²˜ë¦¬í•¨

---

### 4. ì›ì¸: íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ íƒ€ì… í™•ì¥(widening)

```ts
const routes = [{ path: "/" }, { path: "/about" }];
// => path: string (ë¦¬í„°ëŸ´ íƒ€ì… ì•„ë‹˜)

function getPaths<T extends Route>(routes: T[]): T["path"] {
  return routes.map((r) => r.path);
}
```

- ê°ì²´ë‚˜ ë°°ì—´ì„ ë„˜ê¸°ë©´ ê° ì†ì„±ì€ **ë¦¬í„°ëŸ´ì´ ì•„ë‹Œ ì¼ë°˜ string íƒ€ì…**ìœ¼ë¡œ í™•ì¥ë¨

---

### 5. ê¸°ì¡´ í•´ê²° ë°©ë²•: `as const`

```ts
const rtr = router([
  { path: "/", component: Main },
  { path: "/about", component: About },
] as const);
```

- `as const`ë¥¼ ì‚¬ìš©í•˜ë©´ ê° `path`ê°€ `"/"` | `"/about"` ê°™ì€ **ë¦¬í„°ëŸ´ íƒ€ì…ìœ¼ë¡œ ê³ ì •**ë¨
- ë‹¨ì : ì‚¬ìš©ìê°€ `as const`ë¥¼ **ìŠìœ¼ë©´ íƒ€ì… ë³´ì¥ ì‹¤íŒ¨**

---

### 6. ìµœì¢… í•´ê²°ì±…: `const T` ì œë„¤ë¦­ íƒ€ì…

```ts
function router<const T extends Route>(routes: T[]) {
  return {
    navigate(path: T["path"]) {
      // ...
    },
  };
}
```

#### í•µì‹¬
- `const T`ëŠ” **ì œë„¤ë¦­ íƒ€ì…ì´ì§€ë§Œ const contextë¡œ ê³ ì •ë¨**
- í•¨ìˆ˜ ì¸ìì— `as const` ì•ˆ ì¨ë„ `path`ê°€ **ë¦¬í„°ëŸ´ ìœ ë‹ˆì˜¨ íƒ€ì…**ìœ¼ë¡œ ìœ ì§€ë¨

---

### 7. ì‚¬ìš© ì˜ˆ

```ts
const rtr = router([
  { path: "/", component: Main },
  { path: "/about", component: About },
]);

rtr.navigate("/about"); // âœ… OK
rtr.navigate("/faq");   // âŒ ì»´íŒŒì¼ ì—ëŸ¬: "/faq"ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŒ
```

---

### 8. ì •ë¦¬

| ê°œë… | ì„¤ëª… |
|------|------|
| `T extends Route` | ì¼ë°˜ì ì¸ ì œë„¤ë¦­ íƒ€ì… â€” ë¦¬í„°ëŸ´ íƒ€ì… ìœ ì§€ ì•ˆ ë¨ |
| `readonly T[]` ë˜ëŠ” `as const` | ìˆ˜ë™ìœ¼ë¡œ ë¦¬í„°ëŸ´ íƒ€ì… ìœ ì§€ |
| `const T extends Route` | ì œë„¤ë¦­ íƒ€ì…ì— **ë¦¬í„°ëŸ´ ìœ ì§€ ìš”êµ¬** |
| `T["path"]` | `"path"` í•„ë“œë“¤ì˜ ìœ ë‹ˆì˜¨ íƒ€ì… ì¶”ì¶œ (`"/"` \| `"/about"` ë“±) |

---

### 9. ê²°ë¡ 

`const T extends ...`ë¥¼ ì‚¬ìš©í•˜ë©´:

- **ê°œë°œìê°€ `as const`ë¥¼ ë³„ë„ë¡œ ì“¸ í•„ìš” ì—†ìŒ**
- **ë¼ìš°íŒ…, ë©”ë‰´ êµ¬ì„±, ê¶Œí•œ ì œì–´ ë“±**ì—ì„œ ì•ˆì „í•œ ì œë„¤ë¦­ ë¦¬í„°ëŸ´ íƒ€ì…ì„ ì‰½ê²Œ ë³´ì¥í•  ìˆ˜ ìˆìŒ

---